window.BuildingData={tables:{options:{multiTtnPage:{columnDefs:[{targets:"_all",defaultContent:"-"}],columns:[{title:"Number",data:"Number"},{title:"Status",data:"Status",width:"45%"},{title:"DatePayedKeeping",data:"DatePayedKeeping",render:function(t){return(t=t.split(" "))[0]}},{title:"Weight (kg)",data:"DocumentWeight"},{title:"Cost",data:"DocumentCost"}],rowCallback:function(t,e){var a="",n=parseInt(e.StatusCode);7===n||8===n?a="wait":n>=9&&n<=11?a="done":6===n&&(a="soon"),$(t).addClass(a)}},paymentPage:{columnDefs:[{targets:-1,data:"LastCreatedOnTheBasisDocumentType",render:function(t){return"CargoReturn"===t?"Y":""}},{targets:"_all",defaultContent:"-"}],columns:[{title:"Number",data:"Number"},{title:"Status",data:"Status",width:"35%"},{title:"Weight (kg)",data:"DocumentWeight",weight:"5%"},{title:"DatePayedKeeping",data:"DatePayedKeeping",render:function(t){return(t=t.split(" "))[0]}},{title:"OrderId",data:"ClientBarcode"},{title:"Cost",data:"AnnouncedPrice"},{title:"Return",data:"LastCreatedOnTheBasisDocumentType",width:"5%"}]},returnPage:{columnDefs:[{targets:"_all",defaultContent:"-"}],columns:[{title:"Number",data:"Number"},{title:"Status",data:"Status",width:"35%"},{title:"DatePayedKeeping",data:"DatePayedKeeping",render:function(t){return(t=t.split(" "))[0]}},{title:"InitialDocNumber",data:"InitialDocumentNumber"},{title:"Price",data:"AnnouncedPrice"},{title:"Penalty",data:"Cost"}]}}}};
!function(){var t="dateFrom",e="apiKeyArr",o={from:{set:function(e){localStorage.setItem(t,e)},get:function(){return localStorage.getItem(t)},remove:function(){localStorage.removeItem(t)}},to:{set:function(t){localStorage.setItem("dateTo",t)},get:function(){return localStorage.getItem("dateTo")},remove:function(){localStorage.removeItem("dateTo")}}},n={get:function(){return JSON.parse(localStorage.getItem(e))},set:function(t){localStorage.setItem(e,JSON.stringify(t))},remove:function(){localStorage.removeItem(e)}},r={get:function(){return localStorage.getItem("ttnList")},set:function(t){localStorage.setItem("ttnList",t)}};window.ClientStorage={updateTimeRange:function(t,e){o.from.get()!==t&&o.from.set(t),o.to.get()!==e&&o.to.set(e)},updateTtnList:function(t){r.get()!==t&&r.set(t)},getTtnList:function(){return r.get()},getTimeRange:function(){return{from:o.from.get(),to:o.to.get()}},removeTimeRange:function(){o.from.remove(),o.to.remove()},getAccounts:function(){return n.get()},initAccount:function(){n.set([])},setAccount:function(t,e){var o=n.get();o.push({apiKey:t,phoneNumber:e}),n.set(o)},removeAccount:function(t){var e=n.get();e.splice(t,1),n.set(e)},removeAccounts:function(){n.remove()}}}();
var progressBar={update:function(r,t){var a=r+ +$(".progress .progress-bar").attr("aria-valuenow");$(".progress .progress-bar").css("width",a+"%").attr("aria-valuenow",a),$(".progress .val").text(a+"%"),$(".description").text(t)},clear:function(){$(".progress .progress-bar").css("width","0%").attr("aria-valuenow",0),$(".progress .val").text("0%"),$(".description").text("Loading")},calculatePercentage:function(r,t){if(r<t||t<=0)throw new Error("Error! Percent should be >= portion and portion > 0");for(var a=Math.round(r/t),e=a*t-r,o=[],s=0;s<t-1;s++)o.push(a);return e>0||e<0?o.push(a-e):o.push(a),o}};
!function(t){DataStorage={ttnTracking:function(e,a){t.ajax({url:"https://api.novaposhta.ua/v2.0/json/",dataType:"json",type:"post",data:JSON.stringify({modelName:"TrackingDocument",calledMethod:"getStatusDocuments",methodProperties:{Documents:e}}),success:a})},getTtnInfo:function(e,a,o,n){t.ajax({url:"https://api.novaposhta.ua/v2.0/json/",dataType:"json",type:"post",data:JSON.stringify({apiKey:apiKeyArr[i].apiKey,modelName:"InternetDocument",calledMethod:"getDocumentList",methodProperties:{DateTimeFrom:a,DateTimeTo:o,GetFullList:"1",UnassembledCargo:"1"}}),success:n})}}}($);
$(document).ready(function(){$("#menu-item-1").addClass("menu-active"),table=$("#dataTable").DataTable(BuildingData.tables.options.multiTtnPage);var t=ClientStorage.getTtnList();t&&$("#ttnList").val(t)});var table;function sendAjax(t){$.ajax({url:"https://api.novaposhta.ua/v2.0/json/",dataType:"json",type:"post",data:JSON.stringify({modelName:"TrackingDocument",calledMethod:"getStatusDocuments",methodProperties:{Documents:t}}),success:function(t,a){table.clear(),table.rows.add(t.data).draw()}})}$("#checkBtn").click(function(){var t=$("#ttnList").val();console.log("upd"),ClientStorage.updateTtnList(t);for(var a=t.split(", "),e=[],n=0;n<a.length;n++){var s=a[n].split(" ");e.push({DocumentNumber:s[0],Phone:s[1]})}sendAjax(e)}),$("#testBtn").click(function(){for(var t=[],a=parseInt($("#ttnList").val()),e=0;e<50;e++)t.push({DocumentNumber:a+++""});sendAjax(t)});